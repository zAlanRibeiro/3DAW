<html>
    <head>
        <meta charset="utf-8">
        <title>CadastrarAlunos</title>
        <script>
            function registrarAluno(event) {
                event.preventDefault();
                let matricula = document.getElementById("matricula").value;
                let nome = document.getElementById("nome").value;
                let cpf = document.getElementById("cpf").value;
                let nascimento = document.getElementById("nascimento").value;
                let mensagemErro = ValidaForm(matricula, nome, cpf, nascimento);
                if (mensagemErro !== "") {
                    document.getElementById("msg").innerHTML = mensagemErro;
                    return;
                }
                let form2 = {"matricula": matricula,"nome": nome,"cpf": cpf,"data_de_nascimento": nascimento};
                let objJson = JSON.stringify(form2);
                let xmlhttp = new XMLHttpRequest();
                xmlhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        document.getElementById("msg").innerHTML = this.responseText;
                    } else if (this.readyState < 4) {
                        console.log("3: " + this.readyState);
                    } else {
                        console.log("Requisicao falhou: " + this.status);
                    }
                }
                xmlhttp.open("GET", "http://localhost/3DAW/CrudAlunosJavaScript/RegistrarAluno.php?matricula=" + matricula +
                    "&nome=" + nome + "&cpf=" + cpf + "&data_de_nascimento=" + nascimento);
                xmlhttp.send();
            }

            function ValidaForm(pmatricula, pnome, pcpf, pnascimento) {
                let msg = "";
                if (pmatricula == "") msg += "Matrícula não preenchida. <br>";
                if (pnome == "") msg += "Nome não preenchido. <br>";
                if (pcpf == "") msg += "CPF não preenchido. <br>";
                if (pnascimento == "") msg += "Data de nascimento não preenchida. <br>";
                return msg;
            }
        </script>
    </head>
    <body>
        <form action="" method="POST" name="formAluno">
            Nome: <input type="text" name="nome" id="nome">
            <br><br>
            Matricula: <input type="text" name="matricula" id="matricula">
            <br><br>
            Data de Nascimento: <input type="date" name="nascimento" id="nascimento">
            <br><br>
            CPF: <input type="text" name="cpf" placeholder="000.000.000-00" id="cpf">
            <br><br>
            <input type="submit" value="Registrar Aluno!" onclick="registrarAluno(event);">
        </form>
        <div id="msg"></div>
    </body>
</html>
